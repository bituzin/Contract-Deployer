import{aR as I,aS as H,aT as g,an as T,aU as p,ah as l,aj as D,aV as j,aW as A,aX as C,aY as N,aZ as O,a_ as R,ao as E,a$ as v}from"./index-6e4b0420.js";const W=`Ethereum Signed Message:
`;function B(e){const t=(()=>typeof e=="string"?I(e):typeof e.raw=="string"?e.raw:H(e.raw))(),s=I(`${W}${g(t)}`);return T([s,t])}function Z(e,t){return p(B(e),t)}class V extends l{constructor({domain:t}){super(`Invalid domain "${D(t)}".`,{metaMessages:["Must be a valid EIP-712 domain."]})}}class _ extends l{constructor({primaryType:t,types:s}){super(`Invalid primary type \`${t}\` must be one of \`${JSON.stringify(Object.keys(s))}\`.`,{docsPath:"/api/glossary/Errors#typeddatainvalidprimarytypeerror",metaMessages:["Check that the primary type is a key in `types`."]})}}class F extends l{constructor({type:t}){super(`Struct type "${t}" is invalid.`,{metaMessages:["Struct type must not be a Solidity type."],name:"InvalidStructTypeError"})}}function q(e){const{domain:t,message:s,primaryType:n,types:r}=e,a=(m,h)=>{const c={...h};for(const o of m){const{name:y,type:d}=o;d==="address"&&(c[y]=c[y].toLowerCase())}return c},i=(()=>r.EIP712Domain?t?a(r.EIP712Domain,t):{}:{})(),f=(()=>{if(n!=="EIP712Domain")return a(r[n],s)})();return D({domain:i,message:f,primaryType:n,types:r})}function J(e){const{domain:t,message:s,primaryType:n,types:r}=e,a=(i,f)=>{for(const m of i){const{name:h,type:c}=m,o=f[h],y=c.match(j);if(y&&(typeof o=="number"||typeof o=="bigint")){const[z,u,k]=y;A(o,{signed:u==="int",size:Number.parseInt(k,10)/8})}if(c==="address"&&typeof o=="string"&&!C(o))throw new N({address:o});const d=c.match(O);if(d){const[z,u]=d;if(u&&g(o)!==Number.parseInt(u,10))throw new R({expectedSize:Number.parseInt(u,10),givenSize:g(o)})}const b=r[c];b&&(L(c),a(b,o))}};if(r.EIP712Domain&&t){if(typeof t!="object")throw new V({domain:t});a(r.EIP712Domain,t)}if(n!=="EIP712Domain")if(r[n])a(r[n],s);else throw new _({primaryType:n,types:r})}function x({domain:e}){return[typeof(e==null?void 0:e.name)=="string"&&{name:"name",type:"string"},(e==null?void 0:e.version)&&{name:"version",type:"string"},(typeof(e==null?void 0:e.chainId)=="number"||typeof(e==null?void 0:e.chainId)=="bigint")&&{name:"chainId",type:"uint256"},(e==null?void 0:e.verifyingContract)&&{name:"verifyingContract",type:"address"},(e==null?void 0:e.salt)&&{name:"salt",type:"bytes32"}].filter(Boolean)}function G({domain:e}){return P({domain:e,types:{EIP712Domain:x({domain:e})}})}function L(e){if(e==="address"||e==="bool"||e==="string"||e.startsWith("bytes")||e.startsWith("uint")||e.startsWith("int"))throw new F({type:e})}function K(e){const{domain:t={},message:s,primaryType:n}=e,r={EIP712Domain:x({domain:t}),...e.types};J({domain:t,message:s,primaryType:n,types:r});const a=["0x1901"];return t&&a.push(P({domain:t,types:r})),n!=="EIP712Domain"&&a.push(w({data:s,primaryType:n,types:r})),p(T(a))}function P({domain:e,types:t}){return w({data:e,primaryType:"EIP712Domain",types:t})}function w({data:e,primaryType:t,types:s}){const n=S({data:e,primaryType:t,types:s});return p(n)}function S({data:e,primaryType:t,types:s}){const n=[{type:"bytes32"}],r=[U({primaryType:t,types:s})];for(const a of s[t]){const[i,f]=$({types:s,name:a.name,type:a.type,value:e[a.name]});n.push(i),r.push(f)}return E(n,r)}function U({primaryType:e,types:t}){const s=v(X({primaryType:e,types:t}));return p(s)}function X({primaryType:e,types:t}){let s="";const n=M({primaryType:e,types:t});n.delete(e);const r=[e,...Array.from(n).sort()];for(const a of r)s+=`${a}(${t[a].map(({name:i,type:f})=>`${f} ${i}`).join(",")})`;return s}function M({primaryType:e,types:t},s=new Set){const n=e.match(/^\w*/u),r=n==null?void 0:n[0];if(s.has(r)||t[r]===void 0)return s;s.add(r);for(const a of t[r])M({primaryType:a.type,types:t},s);return s}function $({types:e,name:t,type:s,value:n}){if(e[s]!==void 0)return[{type:"bytes32"},p(S({data:n,primaryType:s,types:e}))];if(s==="bytes")return[{type:"bytes32"},p(n)];if(s==="string")return[{type:"bytes32"},p(v(n))];if(s.lastIndexOf("]")===s.length-1){const r=s.slice(0,s.lastIndexOf("[")),a=n.map(i=>$({name:t,type:r,types:e,value:i}));return[{type:"bytes32"},p(E(a.map(([i])=>i),a.map(([,i])=>i)))]}return[{type:s},n]}export{V as I,K as a,_ as b,F as c,P as d,w as e,G as f,x as g,Z as h,W as p,q as s,B as t,J as v};
